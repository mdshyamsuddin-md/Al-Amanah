<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Order Tracking | Al-Amanah</title>

<meta name="viewport" content="width=400, initial-scale=1, maximum-scale=1, user-scalable=no">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
:root{
  --gold:#d4af37;
  --dark:#000000;
  --medium-dark:#1a1a1a;
  --light-grey:#a0a0a0;
  --white:#ffffff;
  --red-cancel:#e74c3c;
}

*{
  box-sizing:border-box;
  font-family:'Poppins',sans-serif;
}

/* üîí FULL PAGE 400px LOCK */
html, body{
  margin:0;
  padding:0;
  width:400px;
  max-width:400px;
  min-width:400px;
  overflow-x:hidden;
  background:var(--medium-dark);
  color:var(--white);
}

/* Center the 400px page on big screens */
body{
  margin:0 auto;
}

/* --- Header --- */
header{
  width:400px;
  background:var(--dark);
  color:var(--gold);
  padding:20px 16px;
  text-align:center;
  font-size:24px;
  font-weight:700;
  letter-spacing:1px;
  box-shadow:0 4px 10px rgba(0,0,0,0.5);
}

/* --- Container --- */
.container{
  width:400px;
  padding:0 16px;
  margin:30px auto;
}

/* --- Card --- */
.card{
  background:var(--dark);
  border-radius:12px;
  padding:20px;
  box-shadow:0 10px 25px rgba(0,0,0,.3),
             0 0 0 1px rgba(255,255,255,0.05);
  margin-bottom:25px;
  border-left:5px solid var(--gold);
}

.product-info h2{
  margin:0;
  font-size:24px;
  font-family:'Playfair Display',serif;
}

.price{
  font-size:22px;
  font-weight:600;
  color:var(--gold);
  margin-top:8px;
}

/* --- Timeline --- */
.timeline{
  border-left:3px solid rgba(212,175,55,0.3);
  padding-left:25px;
}

.step{
  margin-bottom:28px;
  position:relative;
  color:var(--light-grey);
}

.step::before{
  content:"";
  width:16px;
  height:16px;
  background:var(--medium-dark);
  border:2px solid var(--light-grey);
  border-radius:50%;
  position:absolute;
  left:-34px;
  top:50%;
  transform:translateY(-50%);
}

.step.active{
  color:var(--white);
  font-weight:600;
}

.step.active::before{
  background:var(--gold);
  border-color:var(--gold);
  box-shadow:0 0 0 3px rgba(212,175,55,0.3);
}

/* --- Cancel Box --- */
.cancel-box{
  background:var(--dark);
  border-radius:16px;
  padding:30px;
  text-align:center;
  box-shadow:0 0 0 3px var(--red-cancel),
             0 15px 35px rgba(231,76,60,0.3);
  margin-top:40px;
}

.cancel-box h2{
  color:var(--red-cancel);
  font-size:26px;
}

#cancelReason{
  color:var(--red-cancel);
  font-weight:600;
}
</style>
</head>

<body>

<header>Order Tracking / ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç</header>

<div class="container">

  <div class="card product-info">
    <h2 id="pName">Product Name / ‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</h2>
    <div class="price">‚Çπ <span id="pPrice">0</span></div>
  </div>

  <div class="cancel-box" id="cancelBox" style="display:none">
    <h2>‚ùå YOUR ORDER IS CANCELLED</h2>
    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</p>
    <p id="cancelReason"></p>
  </div>

  <div class="card" id="timelineBox">
    <div class="timeline">
      <div class="step" id="step1">Order Placed / ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</div>
      <div class="step" id="step2">Order Confirmed / ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§</div>
      <div class="step" id="step3">Packaging / ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú‡¶ø‡¶Ç</div>
      <div class="step" id="step4">Delivery Processing / ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶ö‡¶≤‡¶õ‡ßá</div>
      <div class="step" id="step5">Delivered /‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§</div>
    </div>
  </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA6G_gK8kYC8I_clx_q0FCG4VXKZXesZOw",
  authDomain: "al-amanah-94f76.firebaseapp.com",
  projectId: "al-amanah-94f76",
  storageBucket: "al-amanah-94f76.firebasestorage.app",
  messagingSenderId: "84938334074",
  appId: "1:84938334074:web:9aef552e8a2cdf44ef40c3"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const params = new URLSearchParams(location.search);
const orderId = params.get("id");

if(orderId){
  const ref = doc(db,"orders",orderId);
  getDoc(ref).then(snap=>{
    if(!snap.exists()){
      alert("Order not found / ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø");
      return;
    }

    const d = snap.data();
    pName.innerText = d.productName || "‡¶™‡¶£‡ßç‡¶Ø";
    pPrice.innerText = d.price || "0";

    if(d.status === "cancelled"){
      timelineBox.style.display="none";
      cancelBox.style.display="block";
      cancelReason.innerText = "‡¶ï‡¶æ‡¶∞‡¶£: " + (d.cancelReason || "‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø");
      return;
    }

    const steps=["placed","confirmed","packaging","delivery","completed"];
    steps.forEach((s,i)=>{
      if(steps.indexOf(d.status)>=i){
        document.getElementById("step"+(i+1)).classList.add("active");
      }
    });
  });
}else{
  alert("No order ID / ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶®‡ßá‡¶á");
}
</script>

</body>
</html>
